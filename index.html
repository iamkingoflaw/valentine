<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Will you be my Valentine?</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  
  <style>
    :root { --primary: #ff4d6d; --secondary: #fbafba; --bg: #ffe6eb; --gold: #ffd700; }
    body { margin: 0; height: 100vh; font-family: 'Poppins', sans-serif; display: flex; justify-content: center; align-items: center; background: var(--bg); overflow: hidden; touch-action: none; }

    #namePortal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1518199266791-5375a83190b7?q=80&w=2070&auto=format&fit=crop') no-repeat center center;
      background-size: cover; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; z-index: 1000; padding: 20px; transition: opacity 0.8s ease;
    }

    @keyframes heartBeat {
      0% { transform: scale(1); text-shadow: 0 0 5px rgba(255, 215, 0, 0.2); }
      50% { transform: scale(1.05); text-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 77, 109, 0.6); color: var(--gold); }
      100% { transform: scale(1); text-shadow: 0 0 5px rgba(255, 215, 0, 0.2); }
    }

    #customText { color: white; margin-bottom: 25px; font-style: italic; font-size: 1.1rem; opacity: 0; font-weight: 600; transition: opacity 2s ease; display: inline-block; padding: 0 15px; line-height: 1.4; z-index: 1001;}
    .pulsing { animation: heartBeat 3s infinite ease-in-out; }

    .card { background: white; padding: 40px; width: 90vw; max-width: 450px; height: 550px; border-radius: 40px; box-shadow: 0 15px 50px rgba(0,0,0,0.1); display: none; flex-direction: column; align-items: center; justify-content: space-between; position: relative; overflow: hidden; z-index: 10; }
    #valentineTitle { color: var(--primary); font-size: 1.8rem; text-align: center; font-weight: 800; margin-top: 20px; z-index: 100; pointer-events: none;}
    #joke-text { color: var(--primary); font-weight: 800; text-transform: uppercase; font-size: 0.75rem; height: 60px; text-align: center; z-index: 100; line-height: 1.2; padding: 0 10px; pointer-events: none;}
    
    #yes { background: var(--primary); color: white; font-size: 20px; font-weight: 700; padding: 15px 45px; border: none; border-radius: 50px; cursor: pointer; transition: transform 0.2s; z-index: 50; }
    
    /* FIXED NO BUTTON DIMENSIONS */
    #no { 
      background: var(--secondary); color: white; 
      width: 130px; height: 45px; 
      display: flex; align-items: center; justify-content: center;
      border: none; border-radius: 50px; 
      position: absolute; cursor: pointer; transition: all 0.15s ease; 
      z-index: 200; bottom: 60px; left: 50%; transform: translateX(-50%); 
      font-size: 0.8rem; font-weight: 600; text-align: center;
    }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 5000; backdrop-filter: blur(8px); }
    .custom-modal { background: white; padding: 30px; border-radius: 30px; width: 90%; max-width: 400px; text-align: center; }
    .primary-btn { background: var(--primary); color: white; border: none; padding: 15px 25px; border-radius: 50px; cursor: pointer; font-weight: 800; width: 100%; margin-top: 15px; }
  </style>
</head>
<body>

  <div id="namePortal">
    <div class="glass-box" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(15px); padding: 40px 25px; border-radius: 30px;">
      <h1 style="color: white; font-weight: 800; margin-bottom: 5px;">My heart is locked.</h1>
      <p id="customText"></p>
      <input type="text" id="userName" style="padding: 15px; border-radius: 50px; border: none; width: 85%; text-align: center;" placeholder="Your name..." onkeydown="if(event.key==='Enter') startApp()">
      <button onclick="startApp()" style="background: var(--primary); color: white; border: none; padding: 15px 40px; border-radius: 50px; font-weight: 800; cursor: pointer; margin-top: 20px;">Unlock My Heart</button>
    </div>
  </div>

  <div class="card" id="mainCard">
    <div id="joke-text">THINK CAREFULLY... üòà</div>
    <h1 id="valentineTitle">Will you be my Valentine?</h1>
    <div style="flex-grow:1; display:flex; align-items:center;"><button id="yes" onclick="yesClick()">Yes</button></div>
    <button id="no" onmouseover="moveNo()">No</button>
  </div>

<script>
  let visitorName = "", clickCount = 0, yesScale = 1, threadId = null;
  const WEBHOOK_URL = "https://discord.com/api/webhooks/1468954384997023777/oL5KyCiivYCBUM3gI0_JWhkKiBV8t6ngFZjZbanUQ_XMUc2E2oWU1_OZw4u0eFfnax7A";

  const taunts = [
    "I HAVE YOUR IP ADDRESS! üìç", "SEARCH HISTORY LEAKING... üîç", "I'M IN YOUR WALLS üß±",
    "POLICE ARE ON THE WAY üëÆ", "PHONE EXPLODING IN 5... üí£", "DELETE YOUR ROBLOX? üéÆ",
    "I'LL TELL YOUR MOM üë©", "JUST CLICK IT ALREADY üôÑ", "WRONG CHOICE! ‚ùå",
    "I'LL STEAL YOUR CAT üêà", "NICKI MINAJ FAN? LEAKED üé§", "I KNOW WHERE YOU LIVE üó∫Ô∏è",
    "RESISTANCE IS FUTILE ü§ñ", "YOU LOOK CUTE STRUGGLING ü•∞", "ALREADY CALLED THE EX üìû",
    "YOUR WIFI IS MINE NOW üì∂", "I'LL REPLACE SHAMPOO WITH GLUE üß¥", "SPOILING YOUR FAV SHOW üì∫",
    "I'LL HIDE YOUR LEFT SHOE üëü", "UNFOLLOWING ON EVERYTHING üì±", "FRONT DOOR IS OPEN üö™",
    "CLOWN SENT TO YOUR HOUSE ü§°", "SALT IN YOUR COFFEE ‚òï", "I'M WATCHING... üìπ",
    "YOUR BEDROOM LIGHT? MINE üí°", "I'LL DELETE YOUR MINECRAFT ‚õèÔ∏è", "Groupchat is watching üó£Ô∏è",
    "I'll hide your keys üîë", "I'll overcook your pasta üçù", "YOUR CRUSH IS TYPING... üí¨",
    "Say No and I post the cringe üì∏", "Groupchat invited üí¨", "I'm your new wallpaper üëπ",
    "I'll eat your lunch üç±", "I'll re-arrange your apps üì±", "YOU'RE TRAPPED üï∏Ô∏è",
    "I'll put a spider in your room üï∑Ô∏è", "Telling everyone you smell üëÉ", "Pizzas ordered (You pay) üçï",
    "I'll change your alarm to a scream üì¢", "I'll drink all the milk ü•õ", "I'll delete your saved passwords üîë",
    "Lego on your floor üß±", "Groupchat knows everything ü§ê", "I'm judging you hard ü§®",
    "I'll hide your charger üîã", "I'll draw a mustache on your poster üé®", "I'll make your pillow warm üõå",
    "Your dreams are mine üåô", "CLICK YES OR ELSE... üî´"
  ];

  window.onload = () => {
    const params = new URLSearchParams(window.location.search);
    if(params.get('to')) document.getElementById('userName').value = params.get('to');
    if(params.get('msg')) {
      const msgEl = document.getElementById('customText');
      msgEl.innerText = `"${decodeURIComponent(params.get('msg'))}"`;
      setTimeout(() => { msgEl.style.opacity = "1"; msgEl.classList.add('pulsing'); }, 800);
    }
  };

  async function trackEvent(event) {
    const url = threadId ? `${WEBHOOK_URL}?thread_id=${threadId}` : WEBHOOK_URL;
    const payload = { content: `**${event}**`, username: visitorName || "Valentine Bot", ...( !threadId && { thread_name: `Session: ${visitorName || "Guest"}` } ) };
    try {
      const res = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
      if (!threadId && res.ok) { const data = await res.json(); threadId = data.id; }
    } catch (e) {}
  }

  function startApp() {
    visitorName = document.getElementById('userName').value.trim();
    if(!visitorName) return;
    trackEvent(`Heart Unlocked by ${visitorName} üîì`);
    document.getElementById('namePortal').style.display = "none";
    document.getElementById('mainCard').style.display = "flex";
  }

  function moveNo() {
    clickCount++;
    const card = document.getElementById("mainCard");
    const noBtn = document.getElementById("no");
    const yesBtn = document.getElementById("yes");
    
    // SAFE BOUNDARIES
    const padding = 60;
    const minY = 180; 
    const maxX = card.clientWidth - 130 - padding;
    const maxY = card.clientHeight - 45 - padding;

    noBtn.style.left = (Math.random() * maxX + padding/2) + "px";
    noBtn.style.top = (Math.random() * (maxY - minY) + minY) + "px";
    noBtn.style.transform = "none"; 

    // BUTTON TEXT CHANGES EVERY TIME
    noBtn.innerText = taunts[clickCount % taunts.length].length > 15 ? "STOP IT!" : taunts[clickCount % taunts.length];

    if (yesScale < 4) { yesScale += 0.25; yesBtn.style.transform = `scale(${yesScale})`; }
    document.getElementById("joke-text").innerText = taunts[clickCount % taunts.length];
  }

  function yesClick() {
    trackEvent("ACCEPTED! ‚ù§Ô∏è");
    confetti({ particleCount: 150, spread: 70 });
    document.getElementById("mainCard").innerHTML = `<div style="text-align:center; margin:auto; padding:20px;"><h1>THANK YOU, ${visitorName.toUpperCase()}! ‚ù§Ô∏è</h1><p>I promise to stay forever. You had no choice anyway.</p></div>`;
  }
</script>
</body>
</html>
